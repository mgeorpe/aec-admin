AEC Development Notes DONE Sep 20 2025

1. Changelog.md - Updated Sep-20
2. README.md - Added one linker link to Git Workflows
3. Created SQL placeholders folders and files -- no scripts
4. VSCode Colorful Terminal
   a. Prompt [mng@iscs-mac aec-admin %]
   b. Command [e.g. git status]
   c. Output 
5. Annoying Passphrase to Git
6. Git Aliases
   a. git config --global alias.st status
   b. git config --global alias.cmt commit
   c. git config --global alias.lg "log --oneline --graph --decorate --all"
7. Schema Inventory
   a. Constraints present: PK, service check, start_year range, status check, type check, FK on country.
   b. Trigger present: enforces upper bound for start_year.   
8. Data Integrity 
   a. Data integrity is clean.
   b. Safe to add a status guard constraint later if you want the DB to enforce it. No fixes required.
   c. Service values all valid (TF/CD/PW/LE).
   d. Years all within allowed bounds.
   e. Required columns all populated.
   f. Status logic already clean.
9. Guardrail for accounts_v2
   “From now on, only allow rows in accounts_v2 where the status, start_year, and is_active columns match the rules we agreed on.” Example:
      If status = prospect → start_year must be empty and is_active = false.
      If status = active → start_year must have a value and is_active = true.
      If status = inactive → is_active must be false (regardless of start_year).

    -- Add as NOT VALID to avoid full-table check during DDL
	ALTER TABLE public.accounts_v2
	ADD CONSTRAINT chk_accounts_v2_status_logic
	CHECK (
  	(status = 'prospect' AND start_year IS NULL AND is_active = false) OR
  	(status = 'active'   AND start_year IS NOT NULL AND is_active = true ) OR
  	(status = 'inactive' AND is_active = false)
	) NOT VALID;

	-- Validate afterwards (will scan rows); do this during a calm moment
	ALTER TABLE public.accounts_v2
	VALIDATE CONSTRAINT chk_accounts_v2_status_logic;
10. Purpose of ".keep" file
    Git by default doesn’t track empty folders.
    Adding a .keep (or .gitkeep, same idea) is a dummy file so the folder itself stays in version control.
      --> sql/migrations/.keep → reserves space for future DDL scripts.
      --> sql/seeds/.keep → placeholder until you add seed files.
      --> sql/sanity/.keep → placeholder until you add sanity query scripts.
    This way, everyone cloning your repo gets the full folder structure, even before any SQL exists.

#########################################
## AEC Development Notes DONE Sep 21 2025
#########################################

11. updated_at trigger - A general-purpose trigger function + hook to accounts_v2 (and reuse later).
12. v_accounts_summary roll up view - A simple rollup view on accounts_v2 so you can quickly see key columns. Useful for sanity checks and for UI lists later.
13. Sanity Query set - Reusable sanity queries for `accounts_v2` and `account_contacts` under `sql/sanity/`.
14. Git Workflows - improved workflow:: acp (add, commit, push) commit prefixes, 
15. Document the View (v_accounts_summary) under Views
16. Reflect and Realignment for next steps


#########################################
## AEC Development Notes DONE Sep 22 2025
#########################################

17. Seed - accounts_v2 (idempotent by account_code). Idempotence refers to an operation that can be applied multiple times without changing the outcome beyond the initial application. In IT systems, designing something to be idempotent ensures consistent results regardless of how many times a request is repeated.

18. Seed - account_contacts_v2 (idempotent by (account_code, full_name, role))

19. ADR - integrity guards on accounts_v2 — status constraint, updated_at trigger, sanity SQL


#########################################
## AEC Development Notes DONE Sep 23 2025
#########################################

20. v_accounts_summary - added contacts_count + sanity check file

21. Legacy Table and Views cleanup --> Inventory & classify (so we know what to keep/drop), Probe Column Results, Fix Account_Learners (remove is_group) - reflected to changelog, readme, ADR.



